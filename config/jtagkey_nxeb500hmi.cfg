tcl_port 6666
telnet_port 4444
gdb_port 3333

#interface
interface ft2232
ft2232_device_desc "Amontec JTAGkey A"
ft2232_layout "jtagkey"
ft2232_vid_pid 0x0403 0xcff8
jtag_khz  6000

#reset_config trst_and_srst|trst_only|srst_only srst_pulls_trst|trst_pulls_srst|combined
reset_config trst_and_srst
#reset_config trst_pulls_srst

jtag_nsrst_delay 500
jtag_ntrst_delay 500

#jtag scan chain
#format L IRC IRCM IDCODE (Length, IR Capture, IR Capture Mask, IDCODE)
jtag newtap netx cpu -irlen 4 -expected-id 0x07926021

target create netx.target0 arm926ejs -endian little -chain-position netx.cpu -variant arm922t

netx.target0 configure -work-area-virt 0x1000 -work-area-phys 0x1000 -work-area-size 0x4000 -work-area-backup 1

netx.target0 configure -event reset-init {
  halt

  arm7_9 fast_memory_access enable
  arm7_9 dcc_downloads disable

  puts "Configuring SDRAM controller for MT48LC8M32 (32MB) "
  mww 0x00100140 0
  mww 0x00100144 0x03C23251
  mww 0x00100140 0x030D0111

  puts "Configuring SRAM nCS0 for 150ns Par. Flash (x16)"
  mww 0x00100100 0x0101000E

  flash probe 0
}

#####################
# Flash configuration
#####################

#flash bank <name> <driver> <base> <size> <chip width> <bus width> <target#>
flash bank parflash cfi 0xC0000000 0x01000000 2 2 netx.target0

init
reset init
